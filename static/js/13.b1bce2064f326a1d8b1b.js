webpackJsonp([13],{M8Tx:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("ewfF"),i=o("Mdjr"),a=o("5aCZ"),s=o("vLgD");var d={created:function(){this.getActiveAbout(),this.getAbouts()},methods:{enableAbout:function(t){var e,o=this;(e={id:t},Object(s.a)({url:"/about/active",method:"get",params:e})).then(function(t){o.getAbouts(),o.getActiveAbout()})},delAbout:function(t){var e=this;if(t.active)return this.$message({message:"被激活的about无法删除，请先更换激活的about再删除",type:"error"}),!1;var o=t.id;this.$confirm("确定要删除吗","提示",{confrimButtonText:"删除",cancelButtonText:"取消"}).then(function(){var t;(t={id:o},Object(s.a)({url:"/about/del",method:"get",params:t})).then(function(t){200==t.code&&(e.$message({message:"删除成功",type:"success"}),e.getAbouts())})})},viewAbout:function(t){var e=this;getAboutById({id:t}).then(function(t){200==t.code&&(e.show.view=!0,e.v.viewContent=decodeURIComponent(t.data.content),e.v.ed.title=t.data.title)})},eidtAbout:function(t){var e,o=this;(e={id:t},Object(s.a)({url:"/about/detail",method:"get",params:e})).then(function(e){200==e.code&&(o.show.addBlog=!0,o.v.editorContent=decodeURIComponent(e.data.content),o.v.title=e.data.title,o.v.aboutId=t)})},getAbouts:function(){var t,e=this;Object(s.a)({url:"/about/get",method:"get",params:t}).then(function(t){200==t.code&&(t.data.content.forEach(function(t){t.content=decodeURIComponent(t.content)}),e.list.abouts=t.data.content)})},addAbout:function(t){var e,o=this;"show"==t&&(this.show.addBlog=!0,this.v.aboutId="",this.v.editorContent="",this.v.title=""),"cancel"==t&&(this.show.addBlog=!1,this.v.aboutId="",this.v.editorContent="",this.v.title=""),"submit"==t&&(this.v.aboutId?(e={content:encodeURIComponent(this.v.editorContent),title:this.v.title,isActive:!1,id:this.v.aboutId},Object(s.a)({url:"/about/update",method:"get",params:e})).then(function(t){o.show.addBlog=!1,o.getAbouts()}):function(t){return Object(s.a)({url:"/about/add",method:"get",params:t})}({content:encodeURIComponent(this.v.editorContent),title:this.v.title,isActive:!1}).then(function(t){200==t.code&&(o.show.addBlog=!1,o.getAbouts())}))},getActiveAbout:function(){var t=this;axios.get("/about/getActive").then(function(e){200==e.code&&e.data.length&&(t.v.activeHTML=decodeURIComponent(e.data[0].content||""))})}},data:function(){return{list:{abouts:[]},show:{addBlog:!1,view:!1},v:{activeHTML:"",editorContent:"",title:"",aboutId:"",ed:{id:"",content:"",title:""}}}},components:{navBar:n.a,flatGreyHead:i.a,tinymce:a.a}},c={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("flatGreyHead"),t._v(" "),o("nav-bar",{attrs:{cur:"6"}}),t._v(" "),o("div",{staticClass:"container"},[o("el-dialog",{attrs:{visible:t.show.view,width:"90%",title:t.v.ed.title},on:{"update:visible":function(e){return t.$set(t.show,"view",e)}}},[o("div",{domProps:{innerHTML:t._s(t.v.viewContent)}})]),t._v(" "),t.show.addBlog?t._e():o("div",[o("div",{domProps:{innerHTML:t._s(t.v.activeHTML)}}),t._v(" "),o("el-divider",[t._v("谢谢")]),t._v(" "),o("br")],1),t._v(" "),t.show.addBlog?o("div",[o("tinymce",{model:{value:t.v.editorContent,callback:function(e){t.$set(t.v,"editorContent",e)},expression:"v.editorContent"}}),t._v(" "),o("el-divider"),t._v(" "),o("el-input",{attrs:{placeholder:"备注",maxlength:200},model:{value:t.v.title,callback:function(e){t.$set(t.v,"title","string"==typeof e?e.trim():e)},expression:"v.title"}}),t._v(" "),o("el-divider"),t._v(" "),o("el-row",[o("el-col",{attrs:{offset:8,span:4}},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addAbout("submit")}}},[t._v("写好了")])],1),t._v(" "),o("el-col",{attrs:{span:4}},[o("el-button",{on:{click:function(e){return t.addAbout("cancel")}}},[t._v("取消")])],1)],1)],1):t._e(),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.show.addBlog,expression:"!show.addBlog"}]},[o("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.addAbout("show")}}},[t._v("添加新about")]),t._v(" "),o("el-table",{attrs:{data:t.list.abouts}},[o("el-table-column",{attrs:{label:"标题","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.title)+"\n            "),e.row.isActive?o("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v("已激活")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"创建时间","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.fdate(parseInt(e.row.createTime))))]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"操作","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{icon:"el-icon-edit",size:"mini",type:"success"},on:{click:function(o){return t.eidtAbout(e.row.id)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{icon:"el-icon-delete",size:"mini",type:"warning"},on:{click:function(o){return t.delAbout(e.row)}}},[t._v("删除")])]}}])}),t._v(" "),o("el-table-column",{attrs:{label:"激活"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isActive?t._e():o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){return t.enableAbout(e.row.id)}}},[t._v("激活")])]}}])})],1)],1)],1)],1)},staticRenderFns:[]};var r=o("VU/8")(d,c,!1,function(t){o("SAG9")},"data-v-267e8b90",null);e.default=r.exports},SAG9:function(t,e){}});