webpackJsonp([6],{"2Sx8":function(t,e,a){"use strict";e.b=function(t){return Object(s.a)({url:"/comment/findCommentsByTarget",method:"get",params:t})},e.a=function(t){return Object(s.a)({url:"/comment/addComment",method:"post",params:t})};var s=a("vLgD")},"5NP7":function(t,e){},Ha40:function(t,e,a){t.exports=a.p+"static/img/数据集成2.3bfc23a.png"},d8J7:function(t,e){},f2Us:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("3SA8"),i=a("5aCZ"),o=a("Mdjr"),l=a("vLgD");var r={props:{value:Object,isEdit:{type:Boolean,default:!1},typ1:{type:Number,default:0}},data:function(){return{show:{addNewPaper:!1},list:{papers:[],paperRanks:[]},v:{paper:{title:"",authors:"",rank:"",keywords:"",dio:""},paperIds:[]}}},created:function(){this.reloadPapers(),this.value.paperIds&&(this.v.paperIds=this.value.paperIds)},methods:{setPaperIds:function(t){this.v.paperIds=t},emitClose:function(){this.$emit("close")},reloadPaperRanks:function(){var t=this;Object(l.a)({url:"/paper/getPaperRanks",method:"get"}).then(function(e){200==e.code&&(t.list.paperRanks=e.data,t.list.paperRanks.length>0&&(t.value.paperRank=t.list.paperRanks[0].id))}).catch()},reloadPapers:function(){var t=this;Object(l.a)({url:"/paper/all",method:"get"}).then(function(e){200==e.code&&(t.list.papers=e.data||[],t.list.papers.forEach(function(t){t.key=t.id,t.label=t.title}))}).catch()},addPaper:function(){var t,e=this,a=this;(t=a.v.paper,Object(l.a)({url:"/paper/add",method:"get",params:t})).then(function(t){200==t.code?(a.$message("添加成功"),e.v.paper={},e.show.addNewPaper=!1,e.reloadPapers()):a.$message("添加失败")}).catch(function(t){a.$message("添加成功")})},filterMethod:function(t,e){return e.title.indexOf(t)>-1},handlePrev:function(){this.$emit("prevStep")},handleFinishCommit:function(){this.value.paperIds=this.v.paperIds.join(","),this.$emit("finishCommit",this.isEdit)}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-top":"50px"}},[a("el-dialog",{attrs:{visible:t.show.addNewPaper,width:"90%"},on:{"update:visible":function(e){return t.$set(t.show,"addNewPaper",e)}}},[a("el-form",{attrs:{size:"small","label-width":"20%"}},[a("el-form-item",{attrs:{label:"文献名称:"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:t.v.paper.title,callback:function(e){t.$set(t.v.paper,"title",e)},expression:"v.paper.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"作者:"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:t.v.paper.authors,callback:function(e){t.$set(t.v.paper,"authors",e)},expression:"v.paper.authors"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"档次:"}},[a("el-select",{model:{value:t.v.paper.rank,callback:function(e){t.$set(t.v.paper,"rank",e)},expression:"v.paper.rank"}},t._l(t.list.paperRanks,function(t,e){return a("el-option",{key:e,attrs:{label:t.content,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"关键词:"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:t.v.paper.keywords,callback:function(e){t.$set(t.v.paper,"keywords",e)},expression:"v.paper.keywords"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"发表日期:"}},[a("el-date-picker",{attrs:{"value-format":"yyyy/MM/dd HH:mm:ss"},model:{value:t.v.paper.publishDate,callback:function(e){t.$set(t.v.paper,"publishDate",e)},expression:"v.paper.publishDate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"dio号码:"}},[a("el-input",{staticStyle:{width:"80%"},model:{value:t.v.paper.dio,callback:function(e){t.$set(t.v.paper,"dio",e)},expression:"v.paper.dio"}})],1),t._v(" "),a("el-form-item",[a("el-button",{on:{click:t.addPaper}},[t._v("添加文献")]),t._v(" "),a("i",{staticClass:"el-icon-check"}),t._v(" "),a("i",{staticClass:"el-icon-close"})],1)],1)],1),t._v(" "),a("el-form",{ref:"productRelationForm",staticStyle:{width:"680px"},attrs:{model:t.value,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"相关文献："}},[a("el-transfer",{staticStyle:{display:"inline-block"},attrs:{filterable:"","filter-method":t.filterMethod,"filter-placeholder":"请输入文献名称",titles:["所有文献","添加到本数据集文献"],data:t.list.papers},model:{value:t.v.paperIds,callback:function(e){t.$set(t.v,"paperIds",e)},expression:"v.paperIds"}})],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:10,offset:8}},[a("el-button",{attrs:{type:"danger",round:""},on:{click:function(e){t.reloadPaperRanks(),t.show.addNewPaper=!0}}},[t._v("添加新文献")])],1)],1)],1),t._v(" "),a("el-form-item",{staticStyle:{"text-align":"center"}},[0==t.typ1?a("el-button",{attrs:{size:"medium"},on:{click:t.handlePrev}},[t._v("上一步")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.handleFinishCommit}},[t._v("完成")]),t._v(" "),1==t.typ1?a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.emitClose}},[t._v("关闭")]):t._e()],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(r,n,!1,function(t){a("5NP7")},null,null).exports,c=a("ewfF"),p=a("2Sx8");var v={components:{flatGreyHead:o.a,datasetPapers:d,navBar:c.a,tinymce:i.a},created:function(){this.dataId=this.$route.query.id,this.reloadDataDetail()},methods:{updatePaperDesc:function(){var t=this;Object(s.g)({datasetId:this.dataId,paperDesc:this.editor.txt.html()}).then(function(e){200==e.code?(t.$message({message:"更新成功",type:"success"}),t.show.editPaperDesc=!1,t.destroyEditor(),t.reloadDataDetail()):t.$message({message:"更新失败",type:"error"})})},initEditor:function(){var t=window.wangEditor;this.editor=new t("#editor"),this.editor.create(),this.editor.txt.html(this.dataset.paperDesc||"")},destroyEditor:function(){document.getElementById("editorDiv").innerHTML="<div id='editor'></div>"},handleChange:function(t){console.log(t)},goBack:function(){this.$router.push("/datas")},addCollect:function(){var t;t={targetId:this.dataId,type:"DATA_COLLECT"},Object(l.a)({url:"/collect/addCollect",method:"get",params:t})},addPapers:function(){var t=this;addDataRefBatch({data_id:this.dataId,paperIds:this.v.paperModel.paperIds}).then(function(e){200==e.code&&t.$message({message:"添加成功",type:"success"})})},editPaperDesc:function(t){"show"==t&&(this.show.editPaperDesc=!0)},delComment:function(t){var e=this;axios.get("/comment/delComment?id="+t).then(function(t){200==t.code&&(e.$message({message:"删除成功",type:"success"}),e.reload_comments())})},addComment:function(){var t=this;Object(p.a)({content:this.comment,targetId:this.dataId}).then(function(e){200==e.code&&(t.$message({message:"添加成功",type:"success"}),t.reload_comments(),t.comment="")})},reload_comments:function(){var t=this;Object(p.b)({targetId:this.dataId}).then(function(e){200==e.code&&(e.data=e.data||[],e.data.forEach(function(t){t.replys=[]}),t.list.comments=e.data)})},reloadReply:function(t){Object(p.b)({targetId:t.id}).then(function(t){200==t.code&&t.replys.push(t.data)})},download:function(t){this.show.download=!0},reloadDataDetail:function(){var t=this;Object(s.c)({id:t.dataId}).then(function(e){200==e.code&&(t.dataset=e.data||{})}).catch(function(t){})}},data:function(){return{editor:"",paperDesc:"",showReplyComments:[],v:{},comment:"",dataset:{id:"",title:"",score:0,isCollect:"",collectCount:"",downloadCount:"",datasetSize:"",datasetDesc:"",datasetTable:"",logo:"",paperText:""},rateScore:0,collectTimes:0,dataId:"",loadings:{},show:{detail_tab:"1",editPaperDesc:!1,download:!1},title:"商品名称",list:{papers:[],comments:[]}}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("flatGreyHead"),t._v(" "),s("navBar",{attrs:{cur:"2"}}),t._v(" "),s("el-dialog",{attrs:{visible:t.show.download,width:"70%",title:"下载"},on:{"update:visible":function(e){return t.$set(t.show,"download",e)}}},[t.dataset.useNetDisk?s("div",[s("h3",[t._v("这是一个存放在百度网盘上的文件，请点击下面的连接跳转到网盘地址")]),t._v(" "),s("hr"),t._v(" "),s("el-form",{attrs:{"label-width":"100px"}},[s("el-form-item",{attrs:{label:"连接地址"}},[s("el-tag",[s("a",{attrs:{href:t.dataset.netDiskUrl,target:"_blank"}},[t._v(t._s(t.dataset.netDiskUrl))])])],1),t._v(" "),s("el-form-item",{attrs:{label:"提取密码"}},[s("el-tag",[t._v(t._s(t.dataset.netDiskPassword))])],1)],1)],1):s("div",[s("h3",[t._v("这是一个存放在服务器上的文件，请点击下面的连接下载")]),t._v(" "),s("hr"),t._v(" "),s("el-tag",[t._v(t._s(t.fileDownloadPath+"?fileCode="+t.dataset.fileCode))])],1)]),t._v(" "),s("div",{staticClass:"ps-product--detail pt-60"},[s("div",{staticClass:"ps-container"},[s("el-page-header",{attrs:{content:t.dataset.title},on:{back:function(e){return t.goBack()}}}),t._v(" "),s("el-divider"),t._v(" "),s("br"),t._v(" "),s("el-row",[s("el-col",{attrs:{span:6,offset:4}},[t.dataset.logo?s("img",{staticStyle:{height:"100%",width:"100%"},attrs:{src:t.fileDownloadPath+"?fileCode="+t.dataset.logo}}):s("img",{staticStyle:{height:"100%",width:"100%",margin:"20px"},attrs:{src:a("Ha40"),alt:""}})]),t._v(" "),s("el-col",{attrs:{span:10,offset:1}},[s("el-form",{staticStyle:{"margin-top":"50px","margin-left":"20px"},attrs:{size:"mini"}},[s("el-form-item",{attrs:{label:"数据评分"}},[s("el-rate",{model:{value:t.dataset.score,callback:function(e){t.$set(t.dataset,"score",e)},expression:"dataset.score"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"收藏次数"}},[t._v(t._s(t.dataset.collectCount))]),t._v(" "),s("el-form-item",{attrs:{label:"下载次数"}},[t._v(t._s(t.dataset.downloadCount))]),t._v(" "),s("el-form-item",{attrs:{label:"数据大小"}},[t._v(t._s(t.dataset.datasetSize))])],1),t._v(" "),s("el-divider"),t._v(" "),s("div",[s("el-button-group",[s("el-button",{staticClass:"el-icon-star-on",attrs:{round:"",size:"mini"},on:{click:function(e){return t.addCollect(t.dataset)}}},[t._v("收藏")]),t._v(" "),s("el-button",{staticClass:"el-icon-download",attrs:{round:"",size:"mini"},on:{click:function(e){return t.download(t.dataset)}}},[t._v("下载")]),t._v(" "),s("el-button",{staticClass:"el-icon-s-promotion",attrs:{round:"",size:"mini"},on:{click:function(e){return t.share(t.dataset)}}},[t._v("分享")])],1)],1)],1)],1),t._v(" "),s("div",{staticClass:"row"},[s("div",{staticClass:"col-lg-10 col-md-12 col-lg-offset-1"},[s("div",{staticClass:"ps-product__info"}),t._v(" "),s("div",{staticClass:"clearfix"}),t._v(" "),s("div",{staticClass:"ps-product__content mt-50"},[s("ul",{staticClass:"tab-list",attrs:{role:"tablist"}},[s("li",{class:{active:1==t.show.detail_tab}},[s("a",{attrs:{"aria-controls":"tab_01"},on:{click:function(e){t.show.detail_tab=1}}},[t._v("数据描述")])]),t._v(" "),s("li",{class:{active:2==t.show.detail_tab}},[s("a",{attrs:{"aria-controls":"tab_02"},on:{click:function(e){t.show.detail_tab=2}}},[t._v("数据表格")])]),t._v(" "),s("li",{class:{active:3==t.show.detail_tab}},[s("a",{attrs:{"aria-controls":"tab_03"},on:{click:function(e){t.show.detail_tab=3,t.reload_comments()}}},[t._v("评论")])]),t._v(" "),s("li",{class:{active:4==t.show.detail_tab}},[s("a",{attrs:{"aria-controls":"tab_04"},on:{click:function(e){t.show.detail_tab=4}}},[t._v("相关文献")])])])]),t._v(" "),s("div",{staticClass:"tab-content mb-60",staticStyle:{"padding-left":"150px","padding-right":"150px","min-height":"600px"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.show.detail_tab,expression:"show.detail_tab==1"}],staticClass:"tab-pane active"},[t.dataset.datasetDesc?s("div",{domProps:{innerHTML:t._s(t.dataset.datasetDesc)}}):s("div",[t._v("偷懒没写...")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2==t.show.detail_tab,expression:"show.detail_tab==2"}],staticClass:"tab-pane active"},[t.dataset.datasetTable?s("div",{domProps:{innerHTML:t._s(t.dataset.datasetTable)}}):s("div",[t._v("偷懒没写...")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:3==t.show.detail_tab,expression:"show.detail_tab==3"}],staticClass:"tab-pane active"},[s("div",{staticClass:"ps-product__tags",staticStyle:{"padding-top":"15px","margin-left":"20%","margin-bottom":"20px"}},[s("div",{staticClass:"form-group"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.comment,expression:"comment",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),s("button",{staticClass:"ps-btn ps-btn--sm",on:{click:function(e){return t.addComment()}}},[t._v("吐槽")])])]),t._v(" "),t.list.comments.length>0?s("div",t._l(t.list.comments,function(e,a){return s("el-row",{key:a},[s("el-col",{attrs:{offset:1,span:18}},[s("p",[t._v(t._s(e.content))])]),t._v(" "),s("el-col",{attrs:{span:1}},[s("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer"},on:{click:function(a){return t.delComment(e.id)}}})]),t._v(" "),s("el-divider")],1)}),1):s("div",{staticStyle:{"text-align":"center"}},[t._v("吐槽都去哪了?")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:4==t.show.detail_tab,expression:"show.detail_tab==4"}],staticClass:"tab-pane active"},[t.dataset.paperText?s("div",{domProps:{innerHTML:t._s(t.dataset.paperText)}}):s("div",{staticStyle:{"padding-top":"20px"}},[t._v("还没有文献敢使用该数据集~")])])])])])],1)])],1)},staticRenderFns:[]};var u=a("VU/8")(v,m,!1,function(t){a("d8J7")},"data-v-09031a55",null);e.default=u.exports}});