webpackJsonp([10],{FbwR:function(t,e,o){"use strict";e.b=function(t){return Object(i.a)({url:"/solution/getSolution",method:"get",params:t})},e.a=function(t){return Object(i.a)({url:"/solution/delSolution",method:"get",params:t})};var i=o("vLgD")},fMu6:function(t,e){},tV1m:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o("Mdjr"),n=o("ewfF"),s=o("5aCZ"),l=o("FbwR"),a=o("vLgD");o("MEhU");var r={components:{flatGreyHead:i.a,tinymce:s.a,navBar:n.a},computed:{userid:function(){return this.$store.getters.getUserId}},beforeMount:function(){var t=document.body.clientWidth;t*=.9,t*=.81,this.v.tinymceWidth=t},created:function(){this.reloadSolutions()},data:function(){return{competitions:[],competitionSponsers:[],editingItem:{solution:{title:"",competitionId:"",createTime:"",rank:0,top:0,logo:"",content:"",creatorUserId:"",link:""},competition:{logo:"",title:"",competitionSponserId:"",link:""},competitionSponser:{logo:"",title:"",link:""}},page:{pageSize:10,pageIndex:1},solution:{title:"",content:"",rank:"",year:2019},isCollapse:!0,v:{solutionType:9},show:{addSolution:!1,addCompetition:!1,addCompetitionSponser:!1},list:{solutions:[],sponsers:[],years:[2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,""].reverse(),ranks:["","TOP1","TOP2","TOP3","TOP5","TOP10","TOP30"]}}},methods:{imgAdd:function(t,e){var o=new FormData;o.append("file",e),fetch(this.dataUploadPath,{method:"POST",headers:{},body:o})},solutionLogoUploadSuccess:function(t,e){this.editingItem.solution.logo=t.fileCode},competitionLogoUploadSuccess:function(t,e){this.editingItem.competition.logo=t.fileCode},competitionSponserLogoUploadSuccess:function(t,e){this.editingItem.competitionSponser.logo=t.fileCode},reloadCompetitionSponsers:function(){var t,e=this;Object(a.a)({url:"/competition/getCompetitionSponsers",method:"get",params:t}).then(function(t){200==t.code?e.competitionSponsers=t.data:e.$message({message:"获取比赛方数据失败",type:"error"})})},addCompetitionSponser:function(t){var e,o=this;"show"==t&&(this.show.addCompetitionSponser=!0,this.editingItem.competitionSponser.logo="",this.editingItem.competitionSponser.title="",this.editingItem.competitionSponser.link=""),"close"==t&&(this.show.addCompetitionSponser=!1,this.editingItem.competitionSponser.logo="",this.editingItem.competitionSponser.title="",this.editingItem.competitionSponser.link=""),"confirm"==t&&(e={name:o.editingItem.competitionSponser.title,logo:o.editingItem.competitionSponser.log,link:o.editingItem.competitionSponser.link},Object(a.a)({url:"/competition/addCompetitionSponser",method:"get",params:e})).then(function(t){200==t.code?(o.$message({message:"添加成功",type:"success"}),o.reloadCompetitionSponsers(),o.show.addCompetitionSponser=!1):o.$message({message:"添加失败",type:"error"})})},addCompetition:function(t){var e,o=this;"show"==t&&(this.show.addCompetition=!0,this.editingItem.competition.logo="",this.editingItem.competition.title="",this.editingItem.competition.link="",this.editingItem.competition.competitionSponserId="",this.reloadCompetitionSponsers()),"confirm"==t&&(e={title:o.editingItem.competition.title,logo:o.editingItem.competition.logo,link:o.editingItem.competition.link,sponserId:o.editingItem.competition.competitionSponserId},Object(a.a)({url:"/competition/addCompetition",method:"get",params:e})).then(function(t){200==t.code?(o.$message({message:"添加成功",type:"success"}),o.show.addCompetition=!1,o.reloadCompetitions()):o.$message({message:"添加失败",type:"error"})})},reloadCompetitions:function(){var t,e=this;Object(a.a)({url:"/competition/getAllCompetitions",method:"get",params:t}).then(function(t){200==t.code?e.competitions=t.data:e.$message({message:"获取竞赛列表失败",type:"error"})})},edit:function(t){var e=this;detail({id:t}).then(function(o){(o.code=200)&&(e.solution.id=t,e.solution.title=o.data.title||"",e.solution.content=decodeURIComponent(o.data.content||""),e.v.logo=o.data.logo||"",e.solution.rank=o.data.rank,e.solution.year=o.data.year,e.solution.sponser=o.data.sponser,e.show.addSolution=!0)})},logoUploadSuccess:function(t,e,o){this.v.logo=t.fileCode},reload_sponsers:function(){var t=this;getCompetionSponsers().then(function(e){200==e.code&&(t.list.sponsers=e.data||[])}).catch()},delSolution:function(t){var e=this;this.$confirm("确定删除吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){Object(l.a)({id:t}).then(function(t){e.reloadSolutions()})})},pageChange:function(t){this.page.pageIndex=t,this.reloadSolutions()},insertSolution:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=this;return""==this.solution.title?(this.$message({message:"标题不能为空",type:"error"}),!1):""==this.solution.content?(this.$message({message:"内容不能为空",type:"error"}),!1):""==this.solution.rank?(this.$message({message:"排名不能为空",type:"error"}),!1):""==this.solution.year?(this.$message({message:"年份不能为空",type:"error"}),!1):(this.solution.content=encodeURIComponent(this.solution.content),void(this.solution.id?editSolution({id:this.solution.id,title:this.solution.title,content:this.solution.content,rank:this.solution.rank,year:this.solution.year,link:this.solution.link}).then(function(e){200==e.code&&(t.solution={},t.show.addSolution=!1)}).catch():insertSolution({title:this.solution.title,content:this.solution.content,rank:this.solution.rank,year:this.solution.year,link:this.solution.link}).then(function(e){200==e.code&&(t.solution={},t.show.addSolution=!1)}).catch()))}),addSolution:function(t,e){var o=this;if("show"==t&&(this.reloadCompetitionSponsers(),this.solution.id="",this.show.addSolution=!0,this.reloadCompetitions()),"edit"==t&&(o.editingItem.solution.id=e.id,o.editingItem.solution.competitionId=e.competition.id,o.editingItem.solution.title=e.solutionTitle,o.editingItem.solution.rank=e.solutionRank,o.editingItem.solution.top=e.solutionTop,o.editingItem.solution.logo=e.logo,o.editingItem.solution.content=e.content,this.show.addSolution=!0,this.reloadCompetitions()),"confirm"==t){var i={competitionId:o.editingItem.solution.competitionId,solutionTitle:o.editingItem.solution.title,solutionRank:o.editingItem.solution.rank,solutionTop:o.editingItem.solution.top,logo:o.editingItem.solution.logo,content:o.editingItem.solution.content};o.editingItem.solution.id&&(i.id=o.editingItem.solution.id),axios.get("/solution/add",{params:i}).then(function(t){200==t.code?(o.$message({message:o.editingItem.solution.id?"编辑成功":"添加成功",type:"success"}),o.reloadSolutions(),o.show.addSolution=!1):o.$message({message:"添加失败",type:"error"})})}},reloadSolutions:function(){var t=this;axios.get("/solution/getSolutionListItem",{params:{pageSize:this.page.pageSize,pageIndex:this.page.pageIndex}}).then(function(e){200==e.code&&(t.list.solutions=e.data.content,t.page.total=e.data.totalElements)}).catch()},handleOpen:function(t,e){console.log(t,e)},handleClose:function(t,e){console.log(t,e)}}},c={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-dialog",{attrs:{visible:t.show.addSolution,width:"90%"},on:{"update:visible":function(e){return t.$set(t.show,"addSolution",e)}}},[o("el-form",{attrs:{"label-width":"10%"}},[o("el-form-item",{attrs:{label:"标题"}},[o("el-input",{model:{value:t.editingItem.solution.title,callback:function(e){t.$set(t.editingItem.solution,"title","string"==typeof e?e.trim():e)},expression:"editingItem.solution.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"来源"}},[o("el-input",{model:{value:t.editingItem.solution.link,callback:function(e){t.$set(t.editingItem.solution,"link","string"==typeof e?e.trim():e)},expression:"editingItem.solution.link"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"比赛"}},[o("el-row",[o("el-col",{attrs:{span:18}},[o("el-select",{model:{value:t.editingItem.solution.competitionId,callback:function(e){t.$set(t.editingItem.solution,"competitionId",e)},expression:"editingItem.solution.competitionId"}},t._l(t.competitions,function(t,e){return o("el-option",{key:e,attrs:{value:t.id,label:t.title}})}),1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addCompetition("show")}}},[t._v("添加比赛")])],1)],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"Rank"}},[o("el-row",[o("el-col",{attrs:{span:2}},[o("el-input",{attrs:{placeholder:""},model:{value:t.editingItem.solution.rank,callback:function(e){t.$set(t.editingItem.solution,"rank",e)},expression:"editingItem.solution.rank"}})],1),t._v(" "),o("el-col",{attrs:{offset:1,span:1}},[t._v("Top")]),t._v(" "),o("el-col",{attrs:{span:2}},[o("el-input",{attrs:{placeholder:""},model:{value:t.editingItem.solution.top,callback:function(e){t.$set(t.editingItem.solution,"top",e)},expression:"editingItem.solution.top"}})],1)],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"Logo"}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.dataUploadPath,"show-file-list":!1,"on-success":t.solutionLogoUploadSuccess}},[t.editingItem.solution.logo?o("img",{staticClass:"avatar",attrs:{src:t.getImgSrc(t.editingItem.solution.logo)}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),o("el-form-item",{attrs:{label:"内容"}},[o("mavon-editor",{on:{imgAdd:t.imgAdd},model:{value:t.editingItem.solution.content,callback:function(e){t.$set(t.editingItem.solution,"content",e)},expression:"editingItem.solution.content"}})],1)],1),t._v(" "),o("el-row",[o("el-col",{attrs:{span:3,offset:10}},[o("el-button",{style:"width:100%",attrs:{type:"primary"},on:{click:function(e){return t.addSolution("confirm")}}},[t._v("写好了")])],1)],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"添加比赛",visible:t.show.addCompetition},on:{"update:visible":function(e){return t.$set(t.show,"addCompetition",e)}}},[o("el-form",{attrs:{"label-position":"left","label-width":"70px"}},[o("el-form-item",{attrs:{label:"Logo"}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.dataUploadPath,"show-file-list":!1,"on-success":t.competitionLogoUploadSuccess}},[t.editingItem.competition.logo?o("img",{staticClass:"avatar",attrs:{src:t.getImgSrc(t.editingItem.competition.logo)}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),o("el-form-item",{attrs:{label:"名称"}},[o("el-input",{attrs:{placeholder:"比赛名称"},model:{value:t.editingItem.competition.title,callback:function(e){t.$set(t.editingItem.competition,"title",e)},expression:"editingItem.competition.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"举办方"}},[o("el-row",[o("el-col",{attrs:{span:18}},[o("el-select",{attrs:{placeholder:""},model:{value:t.editingItem.competition.competitionSponserId,callback:function(e){t.$set(t.editingItem.competition,"competitionSponserId",e)},expression:"editingItem.competition.competitionSponserId"}},t._l(t.competitionSponsers,function(t,e){return o("el-option",{key:e,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),o("el-col",{attrs:{span:3}},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addCompetitionSponser("show")}}},[t._v("添加比赛方")])],1)],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"比赛链接"}},[o("el-input",{attrs:{placeholder:"比赛名称"},model:{value:t.editingItem.competition.link,callback:function(e){t.$set(t.editingItem.competition,"link",e)},expression:"editingItem.competition.link"}})],1)],1),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addCompetition("confirm")}}},[t._v("添加比赛")])],1),t._v(" "),o("el-dialog",{attrs:{title:"添加比赛方",visible:t.show.addCompetitionSponser},on:{"update:visible":function(e){return t.$set(t.show,"addCompetitionSponser",e)}}},[o("el-form",{attrs:{"label-position":"left","label-width":"50px"}},[o("el-form-item",{attrs:{label:"Logo"}},[o("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.dataUploadPath,"show-file-list":!1,"on-success":t.competitionSponserLogoUploadSuccess}},[t.editingItem.competitionSponser.logo?o("img",{staticClass:"avatar",attrs:{src:t.getImgSrc(t.editingItem.competitionSponser.logo)}}):o("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t._v(" "),o("el-form-item",{attrs:{label:"名称"}},[o("el-input",{attrs:{placeholder:"比赛方名称(Kaggle)"},model:{value:t.editingItem.competitionSponser.title,callback:function(e){t.$set(t.editingItem.competitionSponser,"title",e)},expression:"editingItem.competitionSponser.title"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"网站"}},[o("el-input",{model:{value:t.editingItem.competitionSponser.link,callback:function(e){t.$set(t.editingItem.competitionSponser,"link",e)},expression:"editingItem.competitionSponser.link"}})],1)],1),t._v(" "),o("el-button",{staticStyle:{"margin-top":"20px","margin-left":"40%"},attrs:{type:"primary"},on:{click:function(e){return t.addCompetitionSponser("confirm")}}},[t._v("添加比赛方")])],1),t._v(" "),o("flatGreyHead"),t._v(" "),o("nav-bar",{attrs:{cur:"4"}}),t._v(" "),o("el-button",{staticStyle:{"margin-top":"20px","margin-left":"70px"},attrs:{type:"danger"},on:{click:function(e){return t.addSolution("show")}}},[t._v("添加solution")]),t._v(" "),o("el-table",{staticStyle:{margin:"0px 70px"},attrs:{data:t.list.solutions}},[o("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.logo?o("el-avatar",{attrs:{size:"medium",src:t.getImgSrc(e.row.logo)}}):o("el-avatar",{attrs:{size:"medium",src:"https://cube.elemecdn.com/e/fd/0fc7d20532fdaf769a25683617711png.png"}})]}}])}),t._v(" "),o("el-table-column",{scopedSlots:t._u([{key:"default",fn:function(e){return[o("router-link",{attrs:{to:"/cDetail?id="+e.row.id+"&tp=solution"}},[t._v(t._s(e.row.solutionTitle))])]}}])}),t._v(" "),o("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",[t._v("Rank"+t._s(e.row.solutionRank))])]}}])}),t._v(" "),o("el-table-column",{attrs:{width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-tag",[t._v("Top"+t._s(e.row.solutionTop))])]}}])}),t._v(" "),o("el-table-column",{attrs:{width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.userid==e.row.creatorId?o("div",[o("i",{staticClass:"el-icon-edit",staticStyle:{cursor:"pointer"},on:{click:function(o){return t.addSolution("edit",e.row)}}}),t._v(" "),o("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer","margin-left":"30px"},on:{click:function(o){return t.delSolution(e.row.id)}}})]):o("div")]}}])})],1),t._v(" "),o("el-pagination",{staticStyle:{display:"block","margin-left":"30%",width:"40%","margin-top":"30px"},attrs:{total:t.page.total,"page-size":t.page.pageSize,"current-page":t.page.pageIndex},on:{"current-change":t.pageChange}})],1)},staticRenderFns:[]};var d=o("VU/8")(r,c,!1,function(t){o("fMu6")},null,null);e.default=d.exports}});